<!-- <!DOCTYPE html> -->
<html>
<head>
<title>Visor PatoGIS</title>
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>MapServer Layer</title>
    <link rel="stylesheet" href="theme/default/style.css" type="text/css">
    <link rel="stylesheet" href="style.css" type="text/css">
      <script src='http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.1'></script>  
<!-- <script src="http://maps.google.com/maps/api/js?v=3.6&amp;sensor=false"></script> -->
<!--    <script src='http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAjpkAC9ePGem0lIq5XcMiuhR_wWLPFku8Ix9i2SXYRVK3e45q1BQUd_beF8dtzKET_EteAjPdGDwqpQ'></script> -->
    
    <script src="OpenLayers.js"></script>
    <script type="text/javascript">
        var lon = -70;
        var lat = -40;
        var zoom = 5;
        var map, layer, layer1, layer2, layer3;

        function init(){

        // http://bingmapsportal.com/ and use that instead.
        var apiKey = "AqTGBsziZHIJYYxgivLBf0hVdrAk9mWO5cQcb8Yux8sW5M8c8opEC2lZqKR1ZZXf";
/*   var options = {
    singleTile: true,
    ratio: 1,
    isBaseLayer: true,
    wrapDateLine: true,
    getURL: function() {
        var center = this.map.getCenter().transform("EPSG:3857", "EPSG:4326"),
            size = this.map.getSize();
        return [
            this.url, "&center=", center.lat, ",", center.lon,
            "&zoom=", this.map.getZoom(), "&size=", size.w, "x", size.h
        ].join("");
    }
};*/
    //        map = new OpenLayers.Map( 'map' );

    var map = new OpenLayers.Map({
        div: "map",
        projection: "EPSG:900913",
        displayProjection: "EPSG:4326",
        numZoomLevels: 18
    });

            layer = new OpenLayers.Layer.MapServer( "Partidos",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'partidos'},
                    {gutter: 50});
            map.addLayer(layer);
            layer = new OpenLayers.Layer.MapServer( "Localidades",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'localidades'},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer);
            layer = new OpenLayers.Layer.MapServer( "Hidrografía",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'hidrografia'},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer);
            layer = new OpenLayers.Layer.MapServer( "Rutas",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'rutas'},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer);
//
//            layer = new OpenLayers.Layer.MapServer( "Áreas de Interes",
//                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'AreaDeInteres'},
//                    {gutter: 50,isBaseLayer: false, visibility: false});
//            map.addLayer(layer);


  //          layer = new OpenLayers.Layer.MapServer( "Áreas Habilitadas para Caza",
//                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'AreasHabilitadasParaCaza'},
                    //{gutter: 50,isBaseLayer: false, visibility: false});
//            map.addLayer(layer);

            layer = new OpenLayers.Layer.MapServer( "Complejos de Turismo Cinegético",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'ComplejosDeTurismoCinegetico'},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer);

            layer = new OpenLayers.Layer.MapServer( "Puntos de Muestreo",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'PuntosDeMuestreo'},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer);
            layer = new OpenLayers.Layer.MapServer( "Zonas Propuestas de Monitoreo",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'ZonasPropuestasDeMonitoreo'},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer);

            layer1 = new OpenLayers.Layer.MapServer( "Observaciones por Partido",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'obsPartido',campana:"Campaña Septiembre 2011"},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer1);

            layer2 = new OpenLayers.Layer.MapServer( "Ubicaciones",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'lagunas',campana:"Campaña Septiembre 2011"},
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer2);

            layer3 = new OpenLayers.Layer.MapServer( "Observaciones de Ejemplares",
                    "http://grupo11ing.dnsalias.org/cgi-bin/mapserv?map=%2Fvar%2Fwww%2FVisor%2FvisorPatoGIS.map", {layers: 'obsEspecie',campana:"Campaña Septiembre 2011",especie:"%"}, //
                    {gutter: 50,isBaseLayer: false, visibility: false});
            map.addLayer(layer3);



/*            var aerial =
new OpenLayers.Layer.Google(
        "Google Satellite",
        {type: google.maps.MapTypeId.SATELLITE, numZoomLevels: 22}
    );*/
/*new OpenLayers.Layer.Grid(
            "Google Satellite",
            "http://maps.googleapis.com/maps/api/staticmap?sensor=false&maptype=satellite", 
            null, options
        );
*/
//new OpenLayers.Layer.Google("Google Satellite");
//, {
 //       type: G_SATELLITE_MAP, 
  //      sphericalMercator: true,
   //     projection: "EPSG:102113"
    //});
            var aerial = new OpenLayers.Layer.VirtualEarth("Satelital", {
                            type: VEMapStyle.Aerial
                                        });
            map.addLayers([ aerial]);
//new OpenLayers.Layer.Bing({                name: "Aerial",                key: apiKey,                type: "Aerial"            });


	    map.addControl(new OpenLayers.Control.MousePosition());
            map.setCenter(new OpenLayers.LonLat(lon, lat), zoom);
            map.addControl( new OpenLayers.Control.LayerSwitcher() );
	    var panel = new OpenLayers.Control.NavToolbar();
	    map.addControl(panel);
            setTimeout("update()", 10000);

        }
                 function update() {
                                       layer1.redraw(true);
                                       layer2.redraw(true);
                                       layer3.redraw(true);
                                       setTimeout("update()", 10000);
                 }
        function cambiarEspecie() {
            var string = OpenLayers.Util.getElement('especie').value;
            layer3.mergeNewParams({'especie':string});

        }

        function cambiarCampana() {
            var string = OpenLayers.Util.getElement('campana').value;
            layer1.mergeNewParams({'campana':string});
            layer2.mergeNewParams({'campana':string});
            layer3.mergeNewParams({'campana':string});
        }

    </script>
  </head>
  <body onload="init()">
    <h1 id="title">Visor Pato GIS</h1>
    <div id="tags">Pato GIS</div>
    <div id="shortdesc">Visor Pato GIS</div>
    <div id="map" style='width: 1000px; height: 700px;'></div>
    <div id="docs">
        <p>Visualización de los datos cargados por en el sistema PatoGIS y capas tematicas adicionales.</p>
    </div>
<p>Campaña: <select onchange="cambiarCampana()"  id='campana' title='Seleccionar la campaña para filtrar resultados en las capas Observaciones por Partido, Ubicaciones y Observaciones de Ejemplares '>
  <option value="Campaña Septiembre 2011">Campaña Septiembre 2011</option>
  <option value="%">Todas</option>
</select> 
<p>Especie: <input size="14" type='text' id='especie' value="%" onchange="cambiarEspecie()"/>

  </body>
</html>
